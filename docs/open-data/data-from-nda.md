---
title: NDA Data
parent: Open Source Data
nav_enabled: true 
---

# ‚úçÔ∏è Tutorial: Data from NDA

Last updated: Jun 12, 2025

Database: [National Data Archive](https://nda.nih.gov/) at the United States National Institute of Health
Helpdesk Contact: [ndahelp@mail.nih.gov](mailto:ndahelp@mail.nih.gov) 



## 1) Have an eRA Profile

1. Make sure you have an eRA account. If you don‚Äôt have one, email the RBHS signing official, Gregory Werhner ([gw266@research.rutgers.edu](mailto:gw266@research.rutgers.edu)) to have one created for you
2. Ask your PI what institution they‚Äôre assigned to as a PI in NDA. Then put in your employment, making sure to select the same institution as they have. 
    1. For example, there are 2 versions of RBHS. ‚ÄúRutgers Biomedical and Health Sciences‚Äù, and ‚ÄúRutgers Biomedical/Health Sciences - RBHS‚Äù. There‚Äôs also ‚ÄúRutgers, the State University of NJ‚Äù and others. Make sure to select the one that matches your PI
3. Change your contact email to your Rutgers email 

## 2) Get Access to NDA

1. [Create an NDA account](https://nda.nih.gov/nda/tutorials/first_steps_of_data_submission?chapter=your-nda-account) ([nda tutorial](https://nda.nih.gov/nda/tutorials/first_steps_of_data_submission?chapter=your-nda-account)): Go to the NDA website:¬†[https://nda.nih.gov/](https://nda.nih.gov/). To create an account, click the ‚Äúlog in‚Äù button in the top right which will prompt a few ‚Äúcreate account‚Äù options. Make sure to link to your eRA or [login.gov](http://login.gov) which is listed with your institutional email  
2. After/if you already have an account, go to ‚ÄúProfile‚Äù and make sure your institutional affiliation is the same as listed on your eRA account / your PI‚Äôs institutional affiliation.  
    1. If it‚Äôs not, email the helpdesk [ndahelp@mail.nih.gov](mailto:ndahelp@mail.nih.gov) and ask it to be changed   
    NOTE: It takes 48 hours for eRA institution changes to populate to NDA, so if you've just changed your eRA, wait to see if it populates to NDA.   

## 3) Get added to a Data Use Agreement
### 3.1) Be added to an existing DUA for the NDA dataset(s) you wish to use

1. Have the PI/primary requestor follow steps  


### 3.2) Request Access under a new DUA foran NDA dataset(s) you wish to use  
If your PI doesn‚Äôt already have a Data Use Agreement (DUA) for the dataset you wish to use, you must request permissions.  
  
1. First, make sure your PI‚Äôs ‚ÄòInstitutional affiliation‚Äô is the same as yours  
2. Have your PI go to Profile > Data Permissions > scroll down to the collection‚Ä¶ > Request Access (PI must start a request to the data collection that holds the dataset you‚Äôre interested in)  
![data-permissions-request-access.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/data-permissions-request-access.png)

3. Read the instructions carefully to fully understand the process and timeline. Make sure you have selected the correct institutional sponsorship, then click 'Start Request' to begin your application.
![instructions-institution-section-step](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/instructions-institution-section-step)
3. Fill project specific fields‚Äî example responses:  
    1. **Name of Project**: ‚ÄúPsychiatric connectomes‚Äù  
        1. Not important, doesn‚Äôt have to match anywhere else  
    2. **Research purpose:** ‚ÄúOur research is looking at the relationship between biological biomarkers, such as MRI and fMRI, and behavioral markers such as clinical phenotypes and task-behavior. ‚Äú  
4. Fill in the other two fields‚Äî USE THIS LANGUAGE for these questions:  
      
    **Data access plan**: ‚ÄúThe data will be stored on a secure server, in a password protected partition on the Rutgers University Amarel computing cluster. The folder will only be accessible by those listed in this DUA.‚Äù  
      
    **Plan for deletion**: ‚ÄúAll data that has been downloaded from this dataset will be deleted from all our local or cloud-based machines when research is completed, or this DUC is expired, whichever comes first.‚Äú   
      
5. Then add everyone who will access the data. On this page, make sure to add all individuals who will access, use, or analyze the data, regardless of their position title, or role in data usage. This includes any IT staff responsible for cleaning or managing the data.
    1. If the person has an NDA account: but you don‚Äôt see them on the list of ‚ÄúKnown affiliated user‚Äù you have to ask them to follow steps 1.1.-1.3.
        1. Make sure to select the email associated with your collaborator‚Äôs NDA account. Don‚Äôt press ‚Äòadd new user‚Äô unless your collaborator doesn‚Äôt have an NDA account already
![add-user.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/add-user.png)  
  

6. For ‚ÄúSigning Official‚Äù, select Chrissa Pappannoiu ****[cp847@ored.rutgers.edu](mailto:cp847@ored.rutgers.edu)
    1. They will log into NDA to sign your eDAR.
    2. Email Signing official: 
    > ‚ÄúHi Chrissa, 
    > I‚Äôm a researcher in the Holmes Lab, PI: Avram Holmes, and we‚Äôre applying for access to the NDA dataset [Enter dataset name]. The Data Access Request is within NDA for your signature. Thanks so much and please let me know if you have any questions.‚Äù
7. Review the details of your eDAR to ensure everything is correct and click ‚ÄòNext‚Äô to proceed.
8. After reading the Terms and Conditions, check the boxes to certify your agreement, then click 'Confirm' to complete the process.
![data-use-2.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/data-use-2.png)
  
9. Wait to get granted access (~15 business days)  


### 1C) Get added to your PI‚Äôs existing collection/dataset

For PI/Administrators: How to Add Users to Your NDA Collection

---

1. Have the user [create an NDA account](https://nda.nih.gov/nda/tutorials/first_steps_of_data_submission?chapter=your-nda-account).
2. Click on the Permissions tab on your NDA Collection.
    
    ![](https://stage-strapi-public-uploads.s3.amazonaws.com/permissions-tab.jpg)
    
3. Enter either the NDA username or email address of the person you wish to add.
    
    ![](https://stage-strapi-public-uploads.s3.amazonaws.com/username-email-field.jpg)
    
4. Click on search.
    
    ![](https://stage-strapi-public-uploads.s3.amazonaws.com/search-button.jpg)
    
5. Click on Add User.
    
    ![](https://stage-strapi-public-uploads.s3.amazonaws.com/add-user.jpg)
    
6. Apply the [desired permission level](https://nda.nih.gov/nda/tutorials/first_steps_of_data_submission?chapter=collection-permissions#permission-levels).
    
    ![](https://stage-strapi-public-uploads.s3.amazonaws.com/permission-edit-table.png)
    
7. Click Save on the bottom left of the screen.
    
    ![](https://stage-strapi-public-uploads.s3.amazonaws.com/save.png)
    

<aside>
üåü For more information, please see:

PDF Tutorial: [https://rutgers.box.com/s/fh8iv3luan3xonevzyijf185shpzavvm](https://rutgers.box.com/s/fh8iv3luan3xonevzyijf185shpzavvm)

Youtube Tutorial: [NDA Data Access Webinar](https://www.youtube.com/watch?v=53P6hEy-zaM&embeds_referring_euri=https%3A%2F%2Fwww.notion.so%2F&source_ve_path=MjM4NTE&feature=emb_title) 

</aside>

## 2) Creating Python environment for Data Downloads

1. Create Conda environment

```bash
#first create a conda environemnt for the NDA downloader tool. Might not be needed, but was considered good practise the milgram cluster 
conda create --name NDA_download  python=3.11
conda activate NDA_download

#Do this every time
#install nda-tools package:
pip install nda-tools

#see if it worked 
conda list
```

## 3) Downloading Data from NDA to Compute Cluster

1. go to nda.nih.gov
2. sign in 
3. search the dataset you want
    1. Get Data > Text Search > ‚Äúdataset name‚Äù
        
        ![Screen Shot 2024-03-07 at 11.34.56 AM.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/Screen_Shot_2024-03-07_at_11.34.56_AM.png)
        
4. select it from the search results and press ‚ÄúAdd to Workspace‚Äù
    
    ![Screen Shot 2024-03-07 at 11.35.15 AM.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/Screen_Shot_2024-03-07_at_11.35.15_AM.png)
    
5. see that the number of subjects in the ‚Äú**Filter Cart**‚Äù in the upper right hand corner is the appropriate amount. If so, press ‚ÄòCreate Data Package/Add Data to Study‚Äô
    
    ![Screen Shot 2024-03-07 at 11.35.59 AM.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/Screen_Shot_2024-03-07_at_11.35.59_AM.png)
    
6. Press ‚ÄúGo to Data Packaging Page‚Äù (if it doesn‚Äôt automatically) and select from the checkboxes all the data you want
    1. on the left ‚ÄúCollections By Permission Group‚Äù is the collections/datasets and all their iterations
    2. on the right ‚ÄúData Structure by Category‚Äù is the types of data within it
        1. deselect if you don‚Äôt want it
        
        ![Screen Shot 2024-03-07 at 11.37.50 AM.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/Screen_Shot_2024-03-07_at_11.37.50_AM.png)
        
7. Press ‚ÄúCreate Data Package‚Äù button
    1. Clear name so you can reference back
    2. Make SURE to check the box for ‚ÄúInclude associated data files‚Äù
    3. press ‚ÄúCreate Data Package‚Äù 
    
    ![Screen Shot 2024-03-07 at 11.38.53 AM.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/Screen_Shot_2024-03-07_at_11.38.53_AM.png)
    
8. You should get a popup like this. Go to dashboard via link or go to your User Profile ([https://nda.nih.gov/user/dashboard/profile.html](https://nda.nih.gov/user/dashboard/profile.html)) and click on Data Packages
    
    ![Screen Shot 2024-03-07 at 11.40.43 AM.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/Screen_Shot_2024-03-07_at_11.40.43_AM.png)
    
9. Your packages should look like this, including the one you just made. The just-made one will say Status: ‚ÄúCreating Package‚Äù for a couple minutes, but then will populate with Status: ‚ÄúReady to Download‚Äù and the size
    
    ![Screen Shot 2024-03-07 at 11.42.13 AM.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/Screen_Shot_2024-03-07_at_11.42.13_AM.png)
    
10. When it says ‚Äúready to download‚Äù and the size seems right, copy the Package ID Number in the first column for the package you want to download
11. Open text editor (BBEdit, Textedit, VSCode, etc.) and paste this code
    
    (downloadcmd is a command from the package nda-tools)
    
    ```bash
    
    downloadcmd -dp 1225580 -d /projects/f_ah1491_1/Open_Data/NAPLS3 -wt 5
    
    ```
    
- -wt = the number of files you download in parallel. You should use max 10.
- change 1225580 to YOUR PACKAGE ID
- change /projects/f_ah1491_1 to the FOLDER YOU WANT TO DOWNLOAD TO
1. Save this file as a NAME.sh file, and have NAME be relevant to the package you‚Äôre downloading
2. Go to terminal, input chmod `u+rwx [NAME.sh](http://NAME.sh)` to make sure you have execute permissions
3. Code Template:
    
    Just out file
    
    ```bash
    /path/to/my_script.sh 1>/path/to/my_script.out &
    ```
    
    Out file and error file
    
    ```bash
    /path/to/my_script.sh 1>/path/to/my_script.out 2>/path/to/my_script.err &
    ```
    
    This will run your script in the background (&) and save out the terminal outputs into a file with the same name but a different extension (.out) and the error files into that name but (.err)
    

1. It should prompt you here for your username and password from NDA. Make sure these are the credentials that link to the account where you created the data package!
2. Once the job starts running, you can check it‚Äôs running and its progress by entering `sacct`
    1. Your job should be listed in a table like this
    2. your job is the one that says ‚Äòmain‚Äô at the top, in this example it‚Äôs ‚Äòshell_dca+‚Äô (which is the beginning of the [shellfile.sh](http://shellfile.sh) name). this is the one that should be ‚ÄòRUNNING‚Äô and ‚ÄòCOMPLETED‚Äô. if this one fails, the ‚Äòbatch‚Äô or ‚Äòextern‚Äô files may say ‚ÄòCOMPLETED‚Äô, but your job has still failed
        
        ![Screen Shot 2024-03-28 at 6.33.23 PM.png](Tutorial Data from NDA fe5a660f44ed41d481d12daeaee59455/Screen_Shot_2024-03-28_at_6.33.23_PM.png)
        

If it says ‚ÄúFAILED‚Äù:

1. Check the error file by displaying it, it‚Äôs called slurm.most.recent.err if you kept it as I have above, or it‚Äôs called however you defined in the [shellfile.sh](http://shellfile.sh) file
    
    vi slurm.most.recent.err
    
    (:q to quit the vi viewer)
    
    or 
    
    cat slurm.most.recent.err
    

Now that you see the problem, you can try to fix it! 

- if it says ‚Äòpermission denied‚Äô, try making sure both .sh files are fully rwx accessible to you, and the folders that hold those files are as well
- if it says ‚Äòfile cannot be found‚Äô, check all the filepaths in your files for errors, and make sure they line up exactly to where the files are
- if it is a new error or you can‚Äôt figure it out, ask other members of your lab or Rutgers‚Äô Office of Advanced Research Computing (help@oarc.rutgers.edu)

## 4) More Information:

PDF Tutorial: [https://rutgers.box.com/s/fh8iv3luan3xonevzyijf185shpzavvm](https://rutgers.box.com/s/fh8iv3luan3xonevzyijf185shpzavvm)

Youtube Tutorial: [NDA Data Access Webinar](https://www.youtube.com/watch?v=53P6hEy-zaM&embeds_referring_euri=https%3A%2F%2Fwww.notion.so%2F&source_ve_path=MjM4NTE&feature=emb_title) 

[https://www.youtube.com/watch?v=53P6hEy-zaM](https://www.youtube.com/watch?v=53P6hEy-zaM)